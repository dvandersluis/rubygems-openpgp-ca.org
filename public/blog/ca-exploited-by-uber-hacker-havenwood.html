<html>
  <head>
    <title>
      
    </title>
    <link href="/blog/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/assets/application.css?body=1" media="all" rel="stylesheet" type="text/css" />
    <script src="/assets/application.js?body=1" type="text/javascript"></script>
    <meta content="authenticity_token" name="csrf-param" />
    <meta content="USxg1KdEuBsICAhWZXAKxWE7jzckUM6mcN12xGbNe5k=" name="csrf-token" />
  </head>
  <body>
  <script type="text/javascript">
  
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-38732430-1']);
    _gaq.push(['_setDomainName', 'rubygems-openpgp-ca.org']);
    _gaq.push(['_setAllowLinker', true]);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  
  </script>
<div class='header'>
      <div class='project_title'>rubygems-openpgp Certificate Authority</div>
<ul class='menu'>
        <li>
          <a href='/'>
            Home
          </a>
        </li>
        <li>
          Guides
          <ul>
            <li>
              <a href='/blog/the-complete-guide-to-verifying-gems-with-rubygems-openpgp.html'>
                The Complete Guide to Verifying Gems
              </a>
            </li>
            <li>
              <a href='/blog/the-complete-guide-to-signing-the-certificate-authority-keys.html'>
                The Complete Guide to Signing the Certificate Authority Keys
              </a>
            </li>
            <li>
              <a href='/blog/the-complete-guide-to-signing-your-gems.html'>
                The Complete Guide to Signing Your Gems
              </a>
            </li>
            <li>
              <a href='/blog/the-complete-guide-to-verifying-your-initial-install.html'>
                The Complete Guide to Verifying Your Initial Install
              </a>
            </li>
          </ul>
        </li>
        <li>
          Policies
          <ul>
            <li>
              <a href='/blog/authentication.html'>
                Gem Developer Authentication
              </a>
            </li>
            <li>
              <a href='/blog/signing-key-security.html'>
                Signing Key Security
              </a>
            </li>
          </ul>
        </li>
        <li>
          Info
          <ul>
            <li>
              <a href='/blog'>
                Blog
              </a>
            </li>
            <li>
              <a href='/blog/releases.html'>
                Release Announcements
              </a>
            </li>
            <li>
              <a href='/blog/gems-signed-with-rubygems-openpgp.html'>
                Signed Gems
              </a>
            </li>
            <li>
              <a href='/blog/signing-specification.html'>
                Signing Specification
              </a>
            </li>
          </ul>
        </li>
        <li>
          <a href='/blog/contact.html'>
            Contact
          </a>
        </li>
        <li>
          <a href='/users/sign_up'>Apply Now!</a>
        </li>
      </ul>
    </div>

  <div id="post">
<h1>CA Exploited by Uber-Hacker Havenwood!</h1>

<p>On Feb-20-2013 at approximately 10:00 GMT a mysterious user known only
as <a href="https://github.com/havenwood">Havenwood</a> was able to bypass
several layers of security and receive certification from the
authority without proper authentication.</p>

<p>He is believed to be a Caucasian male, between fifteen to fifty years
old, four to six feet high, weighing between one and three hundred
pounds.  If you have any information about his whereabouts, please
contact us.  If you encounter him in person, contact your local
authorities.  Do not attempt to apprehend him yourself.  He is rumored
to be armed and extremely dangerous.</p>

<h3>Actually, That's Not Quite What Happened</h3>

<p>Havenwood submitted an application for certification.  Because of a
bug in the code, we did not realize that he never actually confirmed
his account, which meant that he never demonstrated that he actually
controlled the submitted private key.  In spite of this, we signed off
on his key.</p>

<h3>Game Over?</h3>

<p>Nope.  If we've issued a signature in error, or later decide that a
previously authenticated user has malicious intent, we can revoke our
certification.</p>

<h2>How Revocation Works</h2>

<p>Once the problem was discovered we were able to issue a revocation of
the original signature and send it off to the keyservers.  You can see
the
<a href="http://pool.sks-keyservers.net:11371/pks/lookup?op=vindex&amp;fingerprint=on&amp;search=0xCF61546750DBC4B4">revocation on pool.sks-keyservers.net</a>.</p>

<p>The line starting including <strong>revoke</strong> indicates our original signature
has been revoked.  You will no longer trust the authenticity of
Havenwood's key, at least based on our signature.  If you've
authenticated the key via other means, you'll still trust that and
ignore our revocation.</p>

<h2>How Do Users Get the Revocation Certificate?</h2>

<p>For this revocation to take effect users would need to pull the
revocation down from the keyserver network.  If they've previously
downloaded the key and they never refresh it, they'll never know we
revoked our certification.</p>

<p>To encourage good keyring hygiene we've setup a rotating expiration
date on our signing key.  On May 17th, 2013 the signing key will
expire.  At that time we will bump up the expiration date and publish
this information.</p>

<p>If a user hasn't been keeping their keyring up-to-date, authentication
of users we have certified would start failing on their machine
because the system will think our signing key is expired.  They would
need to refresh their keyring by running:</p>

<pre><code>gpg --keyserver pool.sks-keyservers.net --refresh-keys
</code></pre>

<p>Performing this operation will grab an updated expiration date for our
signing key.  It will also grab our revocation of our signature
against Havenwood's key.  Any attempt to install software signed by
this key with the <code>--trust</code> option would now fail as the key will no
longer be trusted.</p>

<h2>Example</h2>

<p>(This example assumes you've already trusted our keys as described in
<a href="/blog/the-complete-guide-to-signing-the-certificate-authority-keys.html">The Complete Guide to Signing the Certificate Authority Keys</a>.)</p>

<p>Get Havenwood's key and examine the signatures:</p>

<pre><code>gpg --keyserver pool.sks-keyservers.net --recv-key 0x50DBC4B4
gpg --list-sigs 0x50DBC4B4
</code></pre>

<p>You'll see that you have both our original signature and the
revocation.</p>

<p>Here's a message Havenwood signed.  Save this to a file somewhere:</p>

<pre><code>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

This is our world now... the world of the electron and the switch, the beauty of the baud.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (Darwin)

iQIcBAEBAgAGBQJRR1NRAAoJEM9hVGdQ28S00hcQALyHa/3ZpmWY7jwWLoXXZbpc
Pd+MXuH2cmkUBx/Xaeu8FzcNL05svBoZrQn8eJNTRgYN/zD5b8G6eD3a5w4PVO3I
7hP0zN+WRqUBvwuJdq7Ek0cdGNOMU+jGonSCfRhTwTNDBeDWkoIxkiIl+04BmSAD
7kBaHZu0vWbHjWEJkAM26KaE3r/bVYTojVO0D8RKdJ8d6H5nyRW8F3S+b4sHmwXY
hEb9zz1/QkUbU9L4I3I+ag43HAw9ywsTDcWfGk5G3V7aUCWYTMfoIjuEEhQYQAHJ
UcJy0cuJxQtOG6gP3N/x9WSeLmVOleTrJSVuV0CsDw9lR3ALHVZJ5A8HpevKe795
HokoVpwjN4580qKIeRZM2eB+P6sK8CJKXxh8rAqAsgv9TrsfXD8ESKy4iqF0ZS96
wSj5btHLU7Jk511w8wKWLr66fPTLd6wLP/+2Iw5BWntERMPMjICP8erDzw7Lah05
ghiSyj2lifMqwoXe4nznAVmihEjv7tOXE45IlSBc6nBUQxtMMgTzUTuqRbumMLXf
W2TYVYI01Dv/KWjo+XvmLNte8irhIoePRekj/Do0BD9hzYiN6ZrxZw7sgOswo+uV
g+NYUof3jVa2pd7RQo1ihbp0eqrtjQbOf6ZhvbUxu3DDoNkIS8j9DK3kXecoQW1W
A5sPId7OoYQUlId/RprT
=12Qp
-----END PGP SIGNATURE-----
</code></pre>

<p>Check the signature:</p>

<pre><code>johnmudhead:~ grant$ gpg foo.txt.asc 
gpg: Signature made Mon Mar 18 13:43:33 2013 EDT using RSA key ID 50DBC4B4
gpg: Good signature from "Shannon Skipper (havenwood) &lt;blah@example.com&gt;"
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: 06CB 6789 306C 1DC4 BEAE  ABF1 CF61 5467 50DB C4B4
</code></pre>

<p>Note the <strong>WARNING</strong> lines of text.  This is because we our signature
is no longer included in the calculations.</p>

<p>If you ran <code>gem install foo --trust</code> against a gem signed by this key
the operation would now because the key is once again untrusted.</p>

<p>On the other hand, if you trusted the key by other means, for example
because you knew Havenwood personally, the install would succeed.  Our
revocation doesn't state anything good or bad about Havenwood other
than the fact that you should ignore our previous certification.</p>

<h2>And that's how our revocation system works</h2>

<p>Thanks for being a good sport Havenwood.</p>

</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>14 Mar 2013</span> &raquo; <a href="/blog/ca-exploited-by-uber-hacker-havenwood.html">CA Exploited by Uber-Hacker Havenwood! -or- How Revocation Works</a></li>
    
      <li><span>24 Feb 2013</span> &raquo; <a href="/blog/the-complete-guide-to-signing-the-certificate-authority-keys.html">The Complete Guide to Signing the Certificate Authority Keys</a></li>
    
      <li><span>23 Feb 2013</span> &raquo; <a href="/blog/the-complete-guide-to-verifying-gems-with-rubygems-openpgp.html">The Complete Guide to Verifying Gems with rubygems-openpgp</a></li>
    
  </ul>
</div>

 <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rubygems-openpgp-ca'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

  </body>
</html>
